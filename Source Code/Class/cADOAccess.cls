VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
  Persistable = 0  'NotPersistable
  DataBindingBehavior = 0  'vbNone
  DataSourceBehavior  = 0  'vbNone
  MTSTransactionMode  = 0  'NotAnMTSObject
END
Attribute VB_Name = "cADOAccess"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = True
Attribute VB_Ext_KEY = "SavedWithClassBuilder" ,"Yes"
Attribute VB_Ext_KEY = "Top_Level" ,"Yes"
Option Explicit
Private m_Clsdb As adodb.Connection

Private errs1 As Errors
Private rs As adodb.Recordset
Private i As Integer
Private dbConnect As String
Private errLoop As Error
Private strTmp As String
Private m_userid As String
Private m_password As String
Private m_dsn  As String
Private m_Reply As Integer
Public Property Let Password(vpassword As String)
 m_password = vpassword
End Property
Public Property Get Password() As String
   Password = m_password
End Property
Public Property Let DSN(vdsn As String)
m_dsn = vdsn
End Property
Public Property Get DSN() As String
DSN = m_dsn
End Property
Public Property Let UserId(vUserId As String)
  m_userid = vUserId
End Property
Public Property Get UserId() As String
   UserId = m_userid
End Property
Public Property Get OpenData() As adodb.Connection
  Set OpenData = m_Clsdb
End Property
Public Property Get Reply() As Integer
   Reply = m_Reply
End Property

Public Sub SDICnn()
Set m_Clsdb = New adodb.Connection
Set rs = New adodb.Recordset
'Error Handler Variables

'dbConnect = "Provider=SQLOLEDB;Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=SISNCBJ;Data Source=Matrixx"
'dbConnect = dbConnect & ";Packet Size=512;Network Library=DBMSSOCN"
dbConnect = "DSN=" & m_dsn & ";"
'dbConnect = dbConnect & ";uid=" & User & ";pwd="
'dbConnect = dbConnect & Password & ";"


'dbConnect = dbConnect & "User Id=" & m_userid & ";"
'dbConnect = dbConnect & "Password=" & m_password & ";"
On Error GoTo AdoError
m_Clsdb.ConnectionString = dbConnect
m_Clsdb.Open


m_Reply = True
Done:

Exit Sub
AdoError:

On Error Resume Next
i = 1
' process
'--
strTmp = strTmp & vbCrLf & "Vb Error # " & Str(Err.Number)
strTmp = strTmp & vbCrLf & "   Generated by " & Err.Source
strTmp = strTmp & vbCrLf & "   Description  " & Err.Description

' Enumerate Errors Collection and Display properties of
' each dat object.
'--
Set errs1 = m_Clsdb.Errors
For Each errLoop In errs1
    With errLoop
      strTmp = strTmp & vbCrLf & "Error #" & i & ":"
      strTmp = strTmp & vbCrLf & "   ADO Error    #" & .Number
      strTmp = strTmp & vbCrLf & "   Description   " & .Description
      strTmp = strTmp & vbCrLf & "   Source        " & .Source
      i = i + 1
    End With
    Next
    MsgBox strTmp
    On Error Resume Next
    GoTo Done:

  
End Sub


Private Sub Class_Initialize()
 m_userid = ""
 m_password = ""
 m_dsn = ""
 m_Reply = False
End Sub
